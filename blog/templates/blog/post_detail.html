{% extends 'base.html' %}
{% load static %}
{% block canonical %}<link rel="canonical" href="{{ request.scheme }}://{{ request.get_host }}{% url 'post' post.id %}">{% endblock %}

{% block stylesheet %}
	<link rel="stylesheet" type="text/css" href="{{ request.scheme }}://{{ request.get_host }}{% static 'css/blog.css' %}">

	<!-- Full width image: https://stackoverflow.com/questions/12991351/css-force-image-resize-and-keep-aspect-ratio -->
	<style>
		div.main-image {
			background-image: url("{{ request.scheme }}://{{ request.get_host }}{{ post.main_image.url }}");
			background-size: cover;
			background-repeat: no-repeat;
			background-position: center;
			min-height: 75%;
		}
	</style>
{% endblock %}

{% block main_section %}
		<section class="post-main-img background-img font-poppins light-color-text d-flex align-items-stretch" style="background-image: linear-gradient(63deg, rgba(40, 34, 62, 0.8) 50%, rgba(255, 255, 255, 0.3) 100%), url({{ request.scheme }}://{{ request.get_host }}{{ post.main_image.url }});">
			<div class="container main-img-padding pb-2 d-flex align-items-end">
				<div class="d-block">
					<h1 class="light-text">{{ post.title }}</h1>
					<div class="line" style="border-color: #E7F6FF;"></div>
					<p class="light-text">{{ post.subtitle }}</p>
				</div>
			</div>
		</section>
		<article class="mt-3 mb-5">
			<div class="container">
				<div class="media content-section">

					<img class="rounded-circle author-image mr-2" src="{{ request.scheme }}://{{ request.get_host }}{% static 'img/eu.jpg' %}" alt="Foto de {{ post.author }}">
					<div class="media-body">
						<div class="article-metadata">
							<p class="mb-0">Publicado por <a href="{{ request.scheme }}://{{ request.get_host }}{% url 'about' %}">{{ post.author }}</a>{% if not post.published %} <span class="ml-2 badge badge-danger">Não Publicado</span>{% endif %}</p>
							<p class="mt-1 mb-0"><small class="text-muted">Criado em {{ post.date_posted|date }} às {{ post.date_posted|time:"H:i" }}</small></p>
							{% if not post.lt_one_minute_between_creation_and_update %}<p class="mt-0"><small class="text-muted">Última atualização em {{ post.last_updated|date }} às {{ post.last_updated|time:"H:i" }}</small></p>{% endif %}
						</div>
					</div>
				</div>
				{% if user.is_authenticated %}
				<div class="mb-2">
					<div class="d-block mb-1">Controles de administrador:</div>
					<a href="{{ request.scheme }}://{{ request.get_host }}{% url 'post-update' post.slug %}" class="btn btn-primary btn-sm mb-1">Editar Publicação</a>
					<a href="{{ request.scheme }}://{{ request.get_host }}{% url 'post-delete' post.slug %}" class="btn btn-danger btn-sm mb-1">Deletar Publicação</a>
				</div>
				{% endif %}
				{% if post.tag.all %}
				<div class="tag-block">
					<span class="mx-1">Tags:</span>
					{% for tag in post.tag.all %}
					<div class="tag" style="background-color: {{ tag.background_color }}; color: {{ tag.color }}">{{ tag.name }}</div>
					{% endfor %}
				</div>
				{% endif %}
				<hr>
				<div class="article-content">{{ post.content|linebreaks }}</div>
				<a href="{{ request.scheme }}://{{ request.get_host }}{% url 'blog' %}" class="btn btn-info btn-sm">&laquo; Voltar ao Blog</a>
			</div>
		</article>
{% endblock %}
