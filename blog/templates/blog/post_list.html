{% extends 'base.html' %}
{% load static %}
{% block canonical %}<link rel="canonical" href="{% url 'blog' %}">{% endblock %}

{% block stylesheet %}
	<link rel="stylesheet" type="text/css" href="{% static 'css/blog.css' %}">
{% endblock %}

{% block before_main %}
	{% if featured and page_obj.number == 1 %}
	<div class="container featured-articles">
		<h1 class="display-2 font-italic mb-3 border-bottom">Em destaque</h1>
		<div class="jumbotron p-3 p-md-5 text-white rounded bg-dark">
			<div class="col-md-6 px-0">
				<h1 class="display-4 font-italic">Título mais longo para um post destacado</h1>
				<p class="lead my-3">Várias linhas formando uma introdução, informando novos leitores rápido e eficientemente sobre o que é mais interessante, neste post.</p>
				<p class="lead mb-0"><a href="#" class="text-white font-weight-bold">Continue lendo...</a></p>
			</div>
		</div>

		<div class="row mb-2">
			<div class="col-md-6">
				<div class="card flex-md-row mb-4 shadow-sm h-md-250">
					<div class="card-body d-flex flex-column align-items-start">
						<strong class="d-inline-block mb-2 text-primary">Mundo</strong>
						<h3 class="mb-0">
							<a class="text-dark" href="#">Post destacado</a>
						</h3>
						<div class="mb-1 text-muted">12 de Nov</div>
						<p class="card-text mb-auto">Este é um card maior com suporte à texto, em baixo, como uma introdução mais natural ao conteúdo adicional.</p>
						<a href="#">Continue lendo</a>
					</div>
					<img class="card-img-right flex-auto d-none d-lg-block" src="{% static 'placeholder.svg' %}" alt="Card image cap">
				</div>
			</div>
			<div class="col-md-6">
				<div class="card flex-md-row mb-4 shadow-sm h-md-250">
					<div class="card-body d-flex flex-column align-items-start">
						<strong class="d-inline-block mb-2 text-success">Design</strong>
						<h3 class="mb-0">
							<a class="text-dark" href="#">Título do post</a>
						</h3>
						<div class="mb-1 text-muted">11 de Nov</div>
						<p class="card-text mb-auto">Este é um card maior com suporte à texto em baixo, como uma introdução mais natural ao conteúdo adicional.</p>
						<a href="#">Continue lendo</a>
					</div>
					<img class="card-img-right flex-auto d-none d-lg-block" src="{% static 'placeholder.svg' %}" alt="Card image cap">
				</div>
			</div>
		</div>
	</div>
	{% endif %}
{% endblock %}

{% block content %}
			<div class="row">
				<div class="col-md-8 blog-main">
					{% if archive %}
					<h1 class="pb-3 mb-2 display-2">Blog</h1>
					<h2 class="pb-3 mb-4 border-bottom">Publicações de {{ year_month_date|date:"F" }} de {{ year_month_date|date:"Y" }}</h2>
					{% else %}<h1 class="pb-3 mb-4 display-2 border-bottom">Blog</h1>{% endif %}
					{% if user.is_authenticated %}
					<div class="border rounded border-dark mb-4 p-3">
						<h6 class="mb-2"> Controles</h6>
						<a href="{% url 'post-create' %}" class="btn btn-info">Nova Publicação</a>
					</div>
					{% endif %}

					{% for post in posts %}
					<!-- <img src="{{ post.main_image.url }}" class="main-img img-fluid w-100" alt="Article Image"> -->
					<article class="mb-5 rounded article-list blog-post">
						<div class="rounded-top" style="background-image: url('{{ post.main_image.url }}'); background-size: cover; background-repeat: no-repeat; background-position: center; min-height: 75%;">
							<div class="container pt-5 pb-3 {% if post.light_title_text %} light-text{% endif %}">
								<h1 class="header-img display-4"><a class="title" href="{% url 'post' post.id %}">#{{ post.id }} {{ post.title }}</a></h1>
								<h2 class="h4 article-title"><a class="title" href="{% url 'post' post.id %}">{{ post.subtitle }}</a></h2>
							</div>
						</div>
						<div class="container mt-4">
							<div class="media content-section">

								<img class="rounded-circle author-image mr-2" src="{% static 'eu.jpg' %}" alt="Foto de {{ post.author }}">
								<div class="media-body">
									<div class="article-metadata">
										<p class="mb-0">Publicado por <a href="{% url 'about' %}">{{ post.author }}</a></p>
										<p class="mt-1 mb-0"><small class="text-muted">Criado em {{ post.date_posted|date }} às {{ post.date_posted|time:"H:i" }}</small></p>
										{% if not post.lt_one_minute_between_creation_and_update %}<p class="mt-0 mb-0"><small class="text-muted">Última atualização em {{ post.last_updated|date }} às {{ post.last_updated|time:"H:i" }}</small></p>{% endif %}
									</div>
								</div>
								<span class="badge badge-dark">Projeto</span>
								{% if post.draft %}<span class="badge badge-danger ml-1">Rascunho</span>{% endif %}
							</div>
							<hr>
							<p class="article-content">{{ post.content|linebreaks|truncatewords:50 }}</p>
							<p><a href="{% url 'post' post.id %}">Continuar lendo...</a></p>
						</div>
					</article>
					{% endfor %}

					{% if page_obj.paginator.num_pages > 1 %}
					<nav class="mb-4" aria-label="Paginação do Blog">
						<ul class="pagination justify-content-center">
							{% if page_obj.has_previous %}
							<li class="page-item">
								<a class="page-link" href="?pagina=1" aria-label="Primeira Página">
									<span aria-hidden="true">&laquo;</span>
									<span class="sr-only">Primeira Página</span>
								</a>
							</li>
							<li class="page-item"><a class="page-link" href="?pagina={{ page_obj.previous_page_number }}">Anterior</a></li>
							{% else %}
							<li class="page-item disabled">
								<a class="page-link" href="#" tabindex="-1" aria-disabled="true" aria-label="Primeira Página">
									<span aria-hidden="true">&laquo;</span>
									<span class="sr-only">Primeira Página</span>
								</a>
							</li>
							<li class="page-item disabled"><a class="page-link" href="#" tabindex="-1" aria-disabled="true">Anterior</a></li>
							{% endif %}
							{% if 1 < page_obj.number|add:'-2' %}
								<li class="page-item"><a class="page-link" href="?pagina=1">1</a></li>
								{% if 1 < page_obj.number|add:'-3' %}<li class="page-item"><a class="page-link" href="#">...</a></li>{% endif %}
							{% endif %}
							{% for num in page_obj.paginator.page_range %}
								{% if page_obj.number == num %}
									<li class="page-item active">
										<a class="page-link" href="?pagina={{ num }}">{{ num }} <span class="sr-only">(current)</span></a>
									</li>
								{% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
									<li class="page-item"><a class="page-link" href="?pagina={{ num }}">{{ num }}</a></li>
								{% endif %}
							{% endfor %}
							{% if page_obj.number|add:'2' < page_obj.paginator.num_pages %}
								{% if page_obj.number|add:'3' < page_obj.paginator.num_pages %}<li class="page-item"><a class="page-link" href="#">...</a></li>{% endif %}
								<li class="page-item"><a class="page-link" href="?pagina={{ page_obj.paginator.num_pages }}">{{ page_obj.paginator.num_pages }}</a></li>
							{% endif %}
							{% if page_obj.has_next %}
							<li class="page-item"><a class="page-link" href="?pagina={{ page_obj.next_page_number }}">Próxima</a></li>
							<li class="page-item">
								<a class="page-link" href="?pagina={{ page_obj.paginator.num_pages }}" aria-label="Última Página">
									<span aria-hidden="true">&raquo;</span>
									<span class="sr-only">Última Página</span>
								</a>
							</li>
							{% else %}
							<li class="page-item disabled"><a class="page-link" href="#" tabindex="-1" aria-disabled="true">Próxima</a></li>
							<li class="page-item disabled">
								<a class="page-link" href="#" tabindex="-1" aria-disabled="true" aria-label="Última Página">
									<span aria-hidden="true">&raquo;</span>
									<span class="sr-only">Última Página</span>
								</a>
							</li>
							{% endif %}
						</ul>
					</nav>
					{% endif %}

				</div><!-- /.blog-main -->

				<aside class="col-md-4 sticky-top">
					<div class="p-3 mt-4 mb-3 bg-light rounded">
						<h4 class="font-italic">Sobre</h4>
						<p class="mb-0 text-justify">Este é um blog pessoal que eu mantenho para registrar e compartilhar os projetos que eu faço.</p>
						<p class="mb-0 text-justify">Algumas postagens sem relação com os projetos podem surgir; elas estarão marcadas como <i>off-topic</i>.</p>
					</div>

					<div class="p-3">
						<h4 class="font-italic">Arquivos</h4>
						<ol class="list-unstyled mb-0">
						{% for instance in archive_queryset %}
							<li class="font-italic"><a href="{% url 'archive' instance.date_posted_year_month|date:'Y-m' %}">{{ instance.date_posted_year_month|date:"F" }} de {{ instance.date_posted_year_month|date:"Y" }} ({{ instance.num_posts }})</a></li>
						{% endfor %}
						</ol>
					</div>
				</aside><!-- /.blog-sidebar -->

			</div><!-- /.row -->
{% endblock %}